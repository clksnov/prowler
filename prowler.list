                         _
  _ __  _ __ _____      _| | ___ _ __
 | '_ \| '__/ _ \ \ /\ / / |/ _ \ '__|
 | |_) | | | (_) \ V  V /| |  __/ |
 | .__/|_|  \___/ \_/\_/ |_|\___|_|v2.6.1-15November2021
 |_|the handy cloud security tool

Date: Sat Jan  1 19:18:49 CST 2022

 Color code for results: 
 - INFO (Information)
 - PASS (Recommended value)
 - WARNING (Ignored by whitelist)
 - FAIL (Fix required)
1.1 [check11] Avoid the use of the root account - [High]
1.2 [check12] Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password - [High]
1.3 [check13] Ensure credentials unused for 90 days or greater are disabled - [Medium]
1.4 [check14] Ensure access keys are rotated every 90 days or less - [Medium]
1.5 [check15] Ensure IAM password policy requires at least one uppercase letter - [Medium]
1.6 [check16] Ensure IAM password policy require at least one lowercase letter - [Medium]
1.7 [check17] Ensure IAM password policy require at least one symbol - [Medium]
1.8 [check18] Ensure IAM password policy require at least one number - [Medium]
1.9 [check19] Ensure IAM password policy requires minimum length of 14 or greater - [Medium]
1.10 [check110] Ensure IAM password policy prevents password reuse: 24 or greater - [Medium]
1.11 [check111] Ensure IAM password policy expires passwords within 90 days or less - [Medium]
1.12 [check112] Ensure no root account access key exists - [Critical]
1.13 [check113] Ensure MFA is enabled for the root account - [Critical]
1.14 [check114] Ensure hardware MFA is enabled for the root account - [Critical]
1.15 [check115] Ensure security questions are registered in the AWS account - support [Medium]
1.16 [check116] Ensure IAM policies are attached only to groups or roles - [Low]
1.17 [check117] Maintain current contact details - support [Medium]
1.18 [check118] Ensure security contact information is registered - support [Medium]
1.19 [check119] Ensure IAM instance roles are used for AWS resource access from instances - ec2 [Medium]
1.20 [check120] Ensure a support role has been created to manage incidents with AWS Support - [Medium]
1.21 [check121] Do not setup access keys during initial user setup for all IAM users that have a console password - [Medium]
1.22 [check122] Ensure IAM policies that allow full "*:*" administrative privileges are not created - [Medium]
2.1 [check21] Ensure CloudTrail is enabled in all regions - cloudtrail [High]
2.2 [check22] Ensure CloudTrail log file validation is enabled - cloudtrail [Medium]
2.3 [check23] Ensure the S3 bucket CloudTrail logs to is not publicly accessible - cloudtrail [Critical]
2.4 [check24] Ensure CloudTrail trails are integrated with CloudWatch Logs - cloudtrail [Low]
2.5 [check25] Ensure AWS Config is enabled in all regions - configservice [Medium]
2.6 [check26] Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket - s3 [Medium]
2.7 [check27] Ensure CloudTrail logs are encrypted at rest using KMS CMKs - cloudtrail [Medium]
2.8 [check28] Ensure rotation for customer created KMS CMKs is enabled - kms [Medium]
2.9 [check29] Ensure VPC Flow Logging is Enabled in all VPCs - vpc [Medium]
3.1 [check31] Ensure a log metric filter and alarm exist for unauthorized API calls - [Medium]
3.2 [check32] Ensure a log metric filter and alarm exist for Management Console sign-in without MFA - [Medium]
3.3 [check33] Ensure a log metric filter and alarm exist for usage of root account - [Medium]
3.4 [check34] Ensure a log metric filter and alarm exist for IAM policy changes - [Medium]
3.5 [check35] Ensure a log metric filter and alarm exist for CloudTrail configuration changes - cloudtrail [Medium]
3.6 [check36] Ensure a log metric filter and alarm exist for AWS Management Console authentication failures - [Medium]
3.7 [check37] Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created KMS CMKs - kms [Medium]
3.8 [check38] Ensure a log metric filter and alarm exist for S3 bucket policy changes - s3 [Medium]
3.9 [check39] Ensure a log metric filter and alarm exist for AWS Config configuration changes - configservice [Medium]
3.10 [check310] Ensure a log metric filter and alarm exist for security group changes - ec2 [Medium]
3.11 [check311] Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL) - vpc [Medium]
3.12 [check312] Ensure a log metric filter and alarm exist for changes to network gateways - vpc [Medium]
3.13 [check313] Ensure a log metric filter and alarm exist for route table changes - vpc [Medium]
3.14 [check314] Ensure a log metric filter and alarm exist for VPC changes - vpc [Medium]
4.1 [check41] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 22 - ec2 [High]
4.2 [check42] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 3389 - ec2 [High]
4.3 [check43] Ensure the default security group of every VPC restricts all traffic - ec2 [High]
4.4 [check44] Ensure routing tables for VPC peering are "least access" - vpc [Medium]
4.5 [check45] Ensure no Network ACLs allow ingress from 0.0.0.0/0 to SSH port 22 - ec2 [High]
4.6 [check46] Ensure no Network ACLs allow ingress from 0.0.0.0/0 to Microsoft RDP port 3389 - ec2 [High]
7.1 [extra71] Ensure users of groups with AdministratorAccess policy have MFA tokens enabled - [High]
7.2 [extra72] Ensure there are no EBS Snapshots set as Public - ec2 [Critical]
7.3 [extra73] Ensure there are no S3 buckets open to Everyone or Any AWS user - s3 [Critical]
7.4 [extra74] Ensure there are no Security Groups without ingress filtering being used - ec2 [High]
7.5 [extra75] Ensure there are no Security Groups not being used - ec2 [Informational]
7.6 [extra76] Ensure there are no EC2 AMIs set as Public - ec2 [Critical]
7.7 [extra77] Ensure there are no ECR repositories set as Public - ecr [Critical]
7.8 [extra78] Ensure there are no Public Accessible RDS instances - rds [Critical]
7.9 [extra79] Check for internet facing Elastic Load Balancers - elb [Medium]
7.10 [extra710] Check for internet facing EC2 Instances - ec2 [Medium]
7.11 [extra711] Check for Publicly Accessible Redshift Clusters - redshift [High]
7.12 [extra712] Check if Amazon Macie is enabled - macie [Low]
7.13 [extra713] Check if GuardDuty is enabled - guardduty [High]
7.14 [extra714] Check if CloudFront distributions have logging enabled - cloudfront [Medium]
7.15 [extra715] Check if Amazon Elasticsearch Service (ES) domains have logging enabled - es [Medium]
7.16 [extra716] Check if Amazon Elasticsearch Service (ES) domains are set as Public or if it has open policy access - es [Critical]
7.17 [extra717] Check if Elastic Load Balancers have logging enabled - elb [Medium]
7.18 [extra718] Check if S3 buckets have server access logging enabled - s3 [Medium]
7.19 [extra719] Check if Route53 public hosted zones are logging queries to CloudWatch Logs - route53 [Medium]
7.20 [extra720] Check if Lambda functions invoke API operations are being recorded by CloudTrail - lambda [Low]
7.21 [extra721] Check if Redshift cluster has audit logging enabled - redshift [Medium]
7.22 [extra722] Check if API Gateway has logging enabled - apigateway [Medium]
7.23 [extra723] Check if RDS Snapshots and Cluster Snapshots are public - rds [Critical]
7.24 [extra724] Check if ACM certificates have Certificate Transparency logging enabled - acm [Medium]
7.25 [extra725] Check if S3 buckets have Object-level logging enabled in CloudTrail - s3 [Medium]
7.26 [extra726] Check Trusted Advisor for errors and warnings - trustedadvisor [Medium]
7.27 [extra727] Check if SQS queues have policy set as Public - sqs [Critical]
7.28 [extra728] Check if SQS queues have Server Side Encryption enabled - sqs [Medium]
7.29 [extra729] Ensure there are no EBS Volumes unencrypted - ec2 [Medium]
7.30 [extra730] Check if ACM Certificates are about to expire in 7 days or less - acm [High]
7.31 [extra731] Check if SNS topics have policy set as Public - sns [Critical]
7.32 [extra732] Check if Geo restrictions are enabled in CloudFront distributions - cloudfront [Low]
7.33 [extra733] Check if there are SAML Providers then STS can be used - [Low]
7.34 [extra734] Check if S3 buckets have default encryption (SSE) enabled or use a bucket policy to enforce it - s3 [Medium]
7.35 [extra735] Check if RDS instances storage is encrypted - rds [Medium]
7.36 [extra736] Check exposed KMS keys - kms [Critical]
7.38 [extra738] Check if CloudFront distributions are set to HTTPS - cloudfront [Medium]
7.39 [extra739] Check if RDS instances have backup enabled - rds [Medium]
7.40 [extra740] Check if EBS snapshots are encrypted - ec2 [Medium]
7.41 [extra741] Find secrets in EC2 User Data - ec2 [Critical]
7.42 [extra742] Find secrets in CloudFormation outputs - cloudformation [Critical]
7.43 [extra743] Check if API Gateway has client certificate enabled to access your backend endpoint - apigateway [Medium]
7.44 [extra744] Check if API Gateway has a WAF ACL attached - apigateway [Medium]
7.45 [extra745] Check if API Gateway endpoint is public or private - apigateway [Medium]
7.46 [extra746] Check if API Gateway has configured authorizers - apigateway [Medium]
7.47 [extra747] Check if RDS instances is integrated with CloudWatch Logs - rds [Medium]
7.48 [extra748] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to any port - ec2 [High]
7.49 [extra749] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Oracle ports 1521 or 2483 - ec2 [High]
7.50 [extra750] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MySQL port 3306 - ec2 [High]
7.51 [extra751] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Postgres port 5432 - ec2 [High]
7.52 [extra752] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Redis port 6379 - ec2 [High]
7.53 [extra753] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MongoDB ports 27017 and 27018 - ec2 [High]
7.54 [extra754] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Cassandra ports 7199 or 9160 or 8888 - ec2 [High]
7.55 [extra755] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Memcached port 11211 - ec2 [High]
7.57 [extra757] Check EC2 Instances older than 6 months - ec2 [Medium]
7.58 [extra758] Check EC2 Instances older than 12 months  - ec2 [Medium]
7.59 [extra759] Find secrets in Lambda functions variables  - lambda [Critical]
7.60 [extra760] Find secrets in Lambda functions code  - lambda [Critical]
7.61 [extra761] Check if EBS Default Encryption is activated  - ec2 [Medium]
7.62 [extra762] Find obsolete Lambda runtimes  - lambda [Medium]
7.63 [extra763] Check if S3 buckets have object versioning enabled  - s3 [Medium]
7.64 [extra764] Check if S3 buckets have secure transport policy  - s3 [Medium]
7.65 [extra765] Check if ECR image scan on push is enabled  - ecr [Medium]
7.67 [extra767] Check if CloudFront distributions have Field Level Encryption enabled  - cloudfront [Low]
7.68 [extra768] Find secrets in ECS task definitions environment variables  - ecs [Critical]
7.69 [extra769] Check if IAM Access Analyzer is enabled and its findings  - accessanalyzer [High]
7.70 [extra770] Check for internet facing EC2 instances with Instance Profiles attached  - ec2 [Medium]
7.71 [extra771] Check if S3 buckets have policies which allow WRITE access  - s3 [Critical]
7.72 [extra772] Check if elastic IPs are unused  - ec2 [Low]
7.73 [extra773] Check if CloudFront distributions are using WAF  - cloudfront [Medium]
7.74 [extra774] Ensure credentials unused for 30 days or greater are disabled - [Medium]
7.75 [extra775] Find secrets in EC2 Auto Scaling Launch Configuration  - autoscaling [Critical]
7.76 [extra776] Check if ECR image scan found vulnerabilities in the newest image version  - ecr [Medium]
7.77 [extra777] Find VPC security groups with many ingress or egress rules  - ec2 [Medium]
7.78 [extra778] Find VPC security groups with wide-open public IPv4 CIDR ranges (non-RFC1918)  - ec2 [Medium]
7.79 [extra779] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Elasticsearch/Kibana ports - ec2 [High]
7.80 [extra780] Check if Amazon Elasticsearch Service (ES) domains has Amazon Cognito authentication for Kibana enabled - es [High]
7.81 [extra781] Check if Amazon Elasticsearch Service (ES) domains has encryption at-rest enabled - es [Medium]
7.82 [extra782] Check if Amazon Elasticsearch Service (ES) domains has node-to-node encryption enabled - es [Medium]
7.83 [extra783] Check if Amazon Elasticsearch Service (ES) domains has enforce HTTPS enabled - es [Medium]
7.84 [extra784] Check if Amazon Elasticsearch Service (ES) domains internal user database enabled - es [Medium]
7.85 [extra785] Check if Amazon Elasticsearch Service (ES) domains have updates available - es [Low]
7.86 [extra786] Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required  - ec2 [Medium]
7.87 [extra787] Check connection and authentication for Internet exposed Elasticsearch/Kibana ports - es [Critical]
7.88 [extra788] Check connection and authentication for Internet exposed Amazon Elasticsearch Service (ES) domains - es [Critical]
7.89 [extra789] Find trust boundaries in VPC endpoint services connections - vpc [Medium]
7.90 [extra790] Find trust boundaries in VPC endpoint services whitelisted principles - vpc [Medium]
7.91 [extra791] Check if CloudFront distributions are using deprecated SSL protocols - cloudfront [Medium]
7.92 [extra792] Check if Elastic Load Balancers have insecure SSL ciphers  - elb [Medium]
7.93 [extra793] Check if Elastic Load Balancers have SSL listeners  - elb [Medium]
7.94 [extra794] Ensure EKS Control Plane Audit Logging is enabled for all log types - eks [Medium]
7.95 [extra795] Ensure EKS Clusters are created with Private Endpoint Enabled and Public Access Disabled - eks [High]
7.96 [extra796] Restrict Access to the EKS Control Plane Endpoint - eks [High]
7.97 [extra797] Ensure Kubernetes Secrets are encrypted using Customer Master Keys (CMKs) - eks [Medium]
7.98 [extra798] Check if Lambda functions have resource-based policy set as Public - lambda [Critical]
7.99 [extra799] Check if Security Hub is enabled and its standard subscriptions - securityhub [High]
7.100 [extra7100] Ensure that no custom IAM policies exist which allow permissive role assumption (e.g. sts:AssumeRole on *) - [Critical]
7.101 [extra7101] Check if Amazon Elasticsearch Service (ES) domains have audit logging enabled - es [Low]
7.102 [extra7102] Check if any of the Elastic or Public IP are in Shodan (requires Shodan API KEY) - ec2 [High]
7.103 [extra7103] Check if Amazon SageMaker Notebook instances have root access disabled - sagemaker [Medium]
7.104 [extra7104] Check if Amazon SageMaker Notebook instances have VPC settings configured - sagemaker [Medium]
7.105 [extra7105] Check if Amazon SageMaker Models have network isolation enabled - sagemaker [Medium]
7.106 [extra7106] Check if Amazon SageMaker Models have VPC settings configured - sagemaker [Medium]
7.107 [extra7107] Check if Amazon SageMaker Training jobs have intercontainer encryption enabled - sagemaker [Medium]
7.108 [extra7108] Check if Amazon SageMaker Training jobs have volume and output with KMS encryption enabled - sagemaker [Medium]
7.109 [extra7109] Check if Amazon SageMaker Training jobs have network isolation enabled - sagemaker [Medium]
7.110 [extra7110] Check if Amazon SageMaker Training job have VPC settings configured. - sagemaker [Medium]
7.111 [extra7111] Check if Amazon SageMaker Notebook instances have direct internet access - sagemaker [Medium]
7.112 [extra7112] Check if Amazon SageMaker Notebook instances have data encryption enabled - sagemaker [Medium]
7.113 [extra7113] Check if RDS instances have deletion protection enabled  - rds [Medium]
7.114 [extra7114] Check if Glue development endpoints have S3 encryption enabled. - glue [Medium]
7.115 [extra7115] Check if Glue database connection has SSL connection enabled. - glue [Medium]
7.116 [extra7116] Check if Glue data catalog settings have metadata encryption enabled. - glue [Medium]
7.117 [extra7117] Check if Glue data catalog settings have encrypt connection password enabled. - glue [Medium]
7.118 [extra7118] Check if Glue ETL Jobs have S3 encryption enabled. - glue [Medium]
7.119 [extra7119] Check if Glue development endpoints have CloudWatch logs encryption enabled. - glue [Medium]
7.120 [extra7120] Check if Glue ETL Jobs have CloudWatch Logs encryption enabled. - glue [Medium]
7.121 [extra7121] Check if Glue development endpoints have Job bookmark encryption enabled. - glue [Medium]
7.122 [extra7122] Check if Glue ETL Jobs have Job bookmark encryption enabled. - glue [Medium]
7.123 [extra7123] Check if IAM users have two active access keys - [Medium]
7.124 [extra7124] Check if EC2 instances are managed by Systems Manager. - ssm [Medium]
7.125 [extra7125] Check if IAM users have Hardware MFA enabled. - [Medium]
7.126 [extra7126] Check if there are CMK KMS keys not used - kms [Medium]
7.127 [extra7127] Check if EC2 instances managed by Systems Manager are compliant with patching requirements - ssm [High]
7.128 [extra7128] Check if DynamoDB table has encryption at rest enabled using CMK KMS - dynamodb [Medium]
7.129 [extra7129] Check if Application Load Balancer has a WAF ACL attached - elb [Medium]
7.130 [extra7130] Ensure there are no SNS Topics unencrypted - sns [Medium]
7.131 [extra7131] Ensure RDS instances have minor version upgrade enabled - rds [Low]
7.132 [extra7132] Check if RDS instances has enhanced monitoring enabled - rds [Low]
7.133 [extra7133] Check if RDS instances have multi-AZ enabled - rds [Medium]
7.134 [extra7134] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to FTP ports 20 or 21  - ec2 [High]
7.135 [extra7135] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Kafka port 9092  - ec2 [High]
7.136 [extra7136] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Telnet port 23  - ec2 [High]
7.137 [extra7137] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Windows SQL Server ports 1433 or 1434  - ec2 [High]
7.138 [extra7138] Ensure no Network ACLs allow ingress from 0.0.0.0/0 to any port - ec2 [High]
7.139 [extra7139] There are High severity GuardDuty findings  - guardduty [High]
7.140 [extra7140] Check if there are SSM Documents set as public - ssm [High]
7.141 [extra7141] Find secrets in SSM Documents - ssm [Critical]
7.142 [extra7142] Check if Application Load Balancer is dropping invalid packets to prevent header based HTTP request smuggling - elb [Medium]
7.143 [extra7143] Check if EFS have policies which allow access to everyone - efs [Critical]
7.144 [extra7144] Check if CloudWatch has allowed cross-account sharing - cloudwatch [Medium]
7.145 [extra7145] Check if Lambda functions have policies which allow access to any AWS account - lambda [Critical]
7.146 [extra7146] Check if there is any unassigned Elastic IP - ec2 [Low]
7.147 [extra7147] Check if S3 Glacier vaults have policies which allow access to everyone - glacier [Critical]
7.148 [extra7148] Check if EFS File systems have backup enabled - efs [Medium]
7.149 [extra7149] Check if Redshift Clusters have automated snapshots enabled - redshift [Medium]
7.150 [extra7150] Check if Elastic Load Balancers have deletion protection enabled - elb [Medium]
7.151 [extra7151] Check if DynamoDB tables point-in-time recovery (PITR) is enabled - dynamodb [Medium]
7.152 [extra7152] Enable Privacy Protection for for a Route53 Domain - route53 [Medium]
7.153 [extra7153] Enable Transfer Lock for a Route53 Domain - route53 [Medium]
7.154 [extra7154] Enable termination protection for Cloudformation Stacks - cloudformation [Medium]
7.155 [extra7155] Check whether the Application Load Balancer is configured with defensive or strictest desync mitigation mode - elb [Medium]
7.156 [extra7156] Checks if API Gateway V2 has Access Logging enabled - apigateway [Medium]
7.157 [extra7157] Check if API Gateway V2 has configured authorizers - apigateway [Medium]
7.158 [extra7158] Check if ELBV2 has listeners underneath - elb [Medium]
7.159 [extra7159] Check if ELB has listeners underneath - elb [Medium]
